\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{ amssymb }
\usepackage{breqn}
\begin{document}

\title{G for soliton}
\author{Jordan Pitt / u5013521}

\section{PPM Method}
Here I'm just going to rewrite the equations in Coolela and Woodwards landmark paper describing the PPM. 

\[\Delta u_i = u_{i + \frac{1}{2}} - u_{i - \frac{1}{2}}\]
\[u_{6,i} = 6\left(\bar{u}_i - \frac{1}{2}\left(u_{i + \frac{1}{2}} + u_{i - \frac{1}{2}}\right)\right)\]

\begin{dmath*}
u^{int}_{i+ \frac{1}{2}} = \bar{u}_i + \frac{1 \Delta x}{2\Delta x}\left(\bar{u}_{i+1} - \bar{u}_{i}\right) + \frac{1}{4\Delta x}\left\lbrace \frac{2 \Delta x^2}{2 \Delta x} \left[\frac{2 \Delta x}{3 \Delta x} - \frac{2 \Delta x}{3 \Delta x} \right] \left(\bar{u}_{i+1} - \bar{u}_{i-1}\right) - \Delta x \frac{2 \Delta x}{3 \Delta x} \delta u_{i+1} + \Delta x \frac{2 \Delta x}{3 \Delta x}\delta u_{i} \right\rbrace
\end{dmath*}

\begin{dmath*}
u^{int}_{i+ \frac{1}{2}} = \bar{u}_i + \frac{1}{2}\left(\bar{u}_{i+1} - \bar{u}_{i}\right) + \frac{1}{4\Delta x}\left\lbrace - \Delta x \frac{2}{3} \delta u_{i+1} + \Delta x \frac{2}{3}\delta u_{i} \right\rbrace
\end{dmath*}

\begin{dmath*}
u^{int}_{i+ \frac{1}{2}} = \bar{u}_i + \frac{1}{2}\left(\bar{u}_{i+1} - \bar{u}_{i}\right) + \frac{1}{6}\left\lbrace  \delta u_{i} - \delta u_{i+1} \right\rbrace
\end{dmath*}

Where $\delta u_i$ is given by:
\[\delta u_i = \frac{1 \Delta x}{3 \Delta x}\left[\frac{3 \Delta x}{2 \Delta x} \left(\bar{u}_{i+1} - \bar{u}_{i}\right) + \frac{3 \Delta x}{2 \Delta x} \left(\bar{u}_{i} - \bar{u}_{i-1}\right)\right]\]

\[\delta u_i = \frac{1}{3}\left[\frac{3}{2} \left(\bar{u}_{i+1} - \bar{u}_{i}\right) + \frac{3}{2} \left(\bar{u}_{i} - \bar{u}_{i-1}\right)\right]\]

\[\delta u_i = \frac{1}{2}\left[\bar{u}_{i+1} - \bar{u}_{i}  +\bar{u}_{i} - \bar{u}_{i-1}\right]\]

\[\delta u_i = \frac{1}{2}\left[\bar{u}_{i+1} - \bar{u}_{i-1}\right]\]

But actually we want to use $\delta_m u_i$ instead of $\delta u_i$ which is given by

\[\delta_m u_i = \min\left\lbrace |\delta u_i|, 2|\bar{u}_{i+1} - \bar{u}_{i}|, 2|\bar{u}_{i} - \bar{u}_{i-1}| \right\rbrace sgn\left(\delta u_i\right) \]
if $(\bar{u}_{i+1} - \bar{u}_{i})(\bar{u}_{i} - \bar{u}_{i-1}) > 0$ and $0$ otherwise.

Moving onto calculating the edge values:

\[u_{i - \frac{1}{2}} \rightarrow \bar{u}_i \quad , \quad u_{i + \frac{1}{2}} \rightarrow \bar{u}_i \]

if $(u_{i + \frac{1}{2}} - \bar{u}_i)(\bar{u}_i - u_{i - \frac{1}{2}}) \ge 0$

\[u_{i - \frac{1}{2}} \rightarrow 3\bar{u}_i - 2u_{i + \frac{1}{2}}\]
if $\left(u_{i + \frac{1}{2}} -u_{i - \frac{1}{2}}\right)\left(\bar{u}_i - \frac{1}{2} \left(u_{i + \frac{1}{2}} + u_{i - \frac{1}{2}}\right)\right) > \frac{\left(u_{i + \frac{1}{2}} -u_{i - \frac{1}{2}}\right)^2}{6}$

\[u_{i + \frac{1}{2}} \rightarrow 3\bar{u}_i - 2u_{i - \frac{1}{2}}\]
if $\left(u_{i + \frac{1}{2}} -u_{i - \frac{1}{2}}\right)\left(\bar{u}_i - \frac{1}{2} \left(u_{i + \frac{1}{2}} + u_{i - \frac{1}{2}}\right)\right) < - \frac{\left(u_{i + \frac{1}{2}} -u_{i - \frac{1}{2}}\right)^2}{6}$ \\ \\ \\ \\
The parabola generated by the PPM is then the parabola that goes through $u_{i-\frac{1}{2}}$ and $u_{i+\frac{1}{2}}$ with the average of $\bar{u}_i$ over the $i$th cell.

Using Earlier text recon.tex we have:
\[P_i(x) = a(x-x_i)^2 + b(x-x_i) +c \]
The equation giving the correct cell average for $i$ is:
\begin{dmath}
\label{ciint}
\frac{2}{24}a(\Delta x)^2 + c =\bar{u}_i 
\end{dmath}
for the edge values we get that:
\[u_{i - \frac{1}{2}} =P_i(x_{i-\frac{1}{2}}) = a\left(-\frac{1}{2}\Delta x\right)^2 + b\left(-\frac{1}{2}\Delta x\right) +c  \]

\[u_{i + \frac{1}{2}} =P_i(x_{i+\frac{1}{2}}) = a\left(\frac{1}{2}\Delta x\right)^2 + b\left(\frac{1}{2}\Delta x\right) +c  \]

For the first we get:

\[u_{i - \frac{1}{2}} = a\frac{1}{4}\Delta x^2 - b\frac{1}{2}\Delta x +c  \]
For the second:

\[u_{i + \frac{1}{2}} = a\frac{1}{4}\Delta x^2 + b\frac{1}{2}\Delta x +c  \]

Adding them together we get that:

\[u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}}  = a\frac{1}{2}\Delta x^2 + 2c  \]

Taking away 2 times the average equation gives:

\[u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i   = a\frac{1}{2}\Delta x^2  - \frac{4}{24}a(\Delta x)^2   \]

\[u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i   = a\frac{8}{24}\Delta x^2  \]

\[u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i   = a\frac{1}{3}\Delta x^2  \]

\[3 \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{\Delta x^2}   = a \]

Substituting this into the average equation gives:
\[\frac{2}{24} 3 \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{\Delta x^2}  (\Delta x)^2 + c =\bar{u}_i \]

\[\frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{4} + c =\bar{u}_i \]

\[  c = \bar{u}_i - \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{4}\]

Subbing this into the first equation we get that:

\[u_{i - \frac{1}{2}} = 3 \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{\Delta x^2}\frac{1}{4}\Delta x^2 - b\frac{1}{2}\Delta x + \bar{u}_i - \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{4}  \]

\[ b\frac{1}{2}\Delta x= 3 \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{4} + \bar{u}_i - \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{4} - u_{i - \frac{1}{2}}   \]

\[ b\frac{1}{2}\Delta x= \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{2} + \bar{u}_i - u_{i - \frac{1}{2}}   \]

\[ b\frac{1}{2}\Delta x= \frac{u_{i + \frac{1}{2}} - u_{i - \frac{1}{2}}}{2}   \]

\[ b= \frac{u_{i + \frac{1}{2}} - u_{i - \frac{1}{2}}}{\Delta x}   \]

So we have:

\[a = 3 \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{\Delta x^2} \]

\[ b= \frac{u_{i + \frac{1}{2}} - u_{i - \frac{1}{2}}}{\Delta x}   \]

\[  c = \bar{u}_i - \frac{u_{i - \frac{1}{2}} + u_{i + \frac{1}{2}} - 2\bar{u}_i}{4}\]

Also looking at the derivative we get that:
\[P_i'(x) = 2a(x-x_i) + b \]

Discontinuity detection can also be used to steepen curves (this is done before monotonicity corrections).

\[u_{i - \frac{1}{2}} \rightarrow (1 - \eta_i)u_{i - \frac{1}{2}} + (\eta_i)\left(\bar{u}_{i-1} + \frac{1}{2}\delta_m u_{j-1}\right)\]

\[u_{i + \frac{1}{2}} \rightarrow (1 - \eta_i)u_{i + \frac{1}{2}} + (\eta_i)\left(\bar{u}_{i+1} + \frac{1}{2}\delta_m u_{j+1}\right)\]

where:

\[\eta_i = \max \left\lbrace 0, \min \left\lbrace\eta^{(1)} \left(\tilde{\eta}_i - \eta^{(2)}\right) ,1\right\rbrace \right\rbrace\]

where:
\[\tilde{\eta}_i = - \left(\frac{\delta^2u_{i+1} - \delta^2u_{i-1}}{2 \Delta x}\right)\left(\frac{2\Delta x^3}{\bar{u}_{i+1} - \bar{u}_{i-1} }\right)\]

\[\tilde{\eta}_i = - \Delta x^2 \frac{\delta^2u_{i+1} - \delta^2u_{i-1}}{\bar{u}_{i+1} - \bar{u}_{i-1} }\]

if $-\delta^2u_{i+1}\delta^2u_{i-1}$ and $|\bar{u}_{i+1} -\bar{u}_{i-1} | - \epsilon \min \left\lbrace|\bar{u}_{i+1}|,|\bar{u}_{i-1}| \right\rbrace$ are greater than $0$. While being $0$ otherwise.

Where:
\[\delta^2u_{i} = \frac{1}{3 \Delta x} \left[ \frac{\bar{u}_{i+1} - \bar{u}_{i}}{2 \Delta x} - \frac{\bar{u}_{i} - \bar{u}_{i-1}}{2 \Delta x}\right]\]

\[\delta^2u_{i} = \frac{1}{6 \Delta x^2} \left[ \bar{u}_{i + 1} - 2\bar{u}_{i} + \bar{u}_{i - 1} \right]\]











\end{document}
